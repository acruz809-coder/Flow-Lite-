<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flow Integrative ROI Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="bg-gray-50 text-gray-900">
    <div id="root"></div>

    <script type="text/babel">
      const url = new URL(window.location.href);
      const PRO_MODE = url.searchParams.get("pro") === "1"; // add ?pro=1 to enable full pricing/payback

      const { useState } = React;
      const money = (n) => n.toLocaleString(undefined, { style: "currency", currency: "USD" });

      function App() {
        // Shared inputs
        const [price, setPrice] = useState(550);
        const [cogs, setCogs] = useState(20.58);
        const [volume, setVolume] = useState(40);

        // Fixed license base (hidden on public)
        const base = 50000;

        // Standard options (PRO only)
        const [renewal, setRenewal] = useState("No");      // $5,000
        const [mentorship, setMentorship] = useState("No"); // $7,500

        // Lifetime options (PRO only)
        const [tab, setTab] = useState("standard");
        const [buyout, setBuyout] = useState(50000);
        const [updates, setUpdates] = useState("No");       // $5,000
        const [mentorshipLT, setMentorshipLT] = useState("No"); // $7,500

        // Calculations
        const net = price - cogs;
        const monthly = net * volume;
        const annual = monthly * 12;

        // Standard (PRO)
        const afterStd = annual - (renewal === "Yes" ? 5000 : 0) - (mentorship === "Yes" ? 7500 : 0);
        const paybackStd = monthly > 0 ? base / monthly : Infinity;
        const roiStd = base > 0 ? afterStd / base : 0;

        // Lifetime (PRO)
        const totalInvest = base + buyout;
        const afterLT = annual - (updates === "Yes" ? 5000 : 0) - (mentorshipLT === "Yes" ? 7500 : 0);
        const paybackLT = monthly > 0 ? totalInvest / monthly : Infinity;
        const roiLT = totalInvest > 0 ? afterLT / totalInvest : 0;

        return (
          <div className="max-w-5xl mx-auto p-6 space-y-6">
            <header className="space-y-2">
              <h1 className="text-2xl md:text-3xl font-semibold tracking-tight">Flow Integrative — ROI Calculator</h1>
              {!PRO_MODE && (
                <p className="text-sm text-gray-600">Estimate incremental earnings from ketamine IV therapy. No license pricing shown here.</p>
              )}
              {PRO_MODE && (
                <p className="text-sm text-gray-600">Full ROI including payback timeline, renewal/mentorship options, and lifetime buyout.</p>
              )}
            </header>

            {/* Inputs */}
            <section className="bg-white rounded-2xl shadow p-5 border border-gray-100">
              <h2 className="text-lg font-semibold mb-3">Inputs</h2>
              <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                <Field label="Per-Infusion Revenue ($)">
                  <input type="number" min="400" max="750" value={price} onChange={(e)=>setPrice(+e.target.value)}
                    className="w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-black/20"/>
                  <Hint>Range: $400–$750 (default $550)</Hint>
                </Field>
                <Field label="Infusions per Month">
                  <input type="number" min="1" step="1" value={volume} onChange={(e)=>setVolume(+e.target.value)}
                    className="w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-black/20"/>
                  <Hint>Typical: 20–60</Hint>
                </Field>
                <Field label="COGS per Infusion ($)">
                  <input type="number" step="0.01" value={cogs} onChange={(e)=>setCogs(+e.target.value)}
                    className="w-full rounded-lg border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-black/20"/>
                  <Hint>Default: $20.58</Hint>
                </Field>
              </div>
            </section>

            {/* Public results */}
            <section className="bg-white rounded-2xl shadow p-5 border border-gray-100">
              <h3 className="text-lg font-semibold mb-3">Results</h3>
              <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                <Tile label="Net per infusion" value={money(net)} />
                <Tile label="Estimated monthly net" value={money(monthly)} />
                <Tile label="Estimated annual net" value={money(annual)} />
              </div>

              {!PRO_MODE && (
                <div className="mt-4 space-y-2">
                  <a href="/contact" className="inline-flex items-center px-4 py-2 rounded-lg bg-black text-white">Get your payback timeline & certification options</a>
                  <div className="text-xs text-gray-500">Detailed ROI, payback, and pricing provided in a consult.</div>
                </div>
              )}
            </section>

            {/* PRO controls */}
            {PRO_MODE && (
              <>
                <nav className="flex items-center gap-2">
                  <button onClick={()=>setTab('standard')} className={tab==='standard'?'px-4 py-2 rounded-full bg-black text-white':'px-4 py-2 rounded-full border'}>Standard License</button>
                  <button onClick={()=>setTab('lifetime')} className={tab==='lifetime'?'px-4 py-2 rounded-full bg-black text-white':'px-4 py-2 rounded-full border'}>Lifetime Buyout</button>
                </nav>

                {tab === 'standard' ? (
                  <section className="bg-white rounded-2xl shadow p-5 border border-gray-100 space-y-4">
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                      <Field label="$5,000 Certification Renewal">
                        <Select yesLabel="Yes" noLabel="No" value={renewal} onChange={setRenewal} />
                      </Field>
                      <Field label="$7,500 Mentorship & Community">
                        <Select yesLabel="Yes" noLabel="No" value={mentorship} onChange={setMentorship} />
                      </Field>
                      <Field label="Base License (fixed)">
                        <div className="rounded-lg border bg-gray-100 text-gray-600 px-3 py-2">$50,000</div>
                      </Field>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                      <Tile label="Annual (after options)" value={money(afterStd)} />
                      <Tile label="Payback (months)" value={Number.isFinite(paybackStd)? paybackStd.toFixed(2) : '—'} />
                      <Tile label="Year‑1 ROI" value={`${roiStd.toFixed(2)}×`} />
                    </div>
                  </section>
                ) : (
                  <section className="bg-white rounded-2xl shadow p-5 border border-gray-100 space-y-4">
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                      <Field label="Lifetime Buyout Fee ($)">
                        <input type="number" min="0" step="100" value={buyout} onChange={(e)=>setBuyout(+e.target.value)}
                          className="w-full rounded-lg border border-gray-300 px-3 py-2"/>
                      </Field>
                      <Field label="$5,000 Annual Updates & CE Pack">
                        <Select yesLabel="Yes" noLabel="No" value={updates} onChange={setUpdates} />
                      </Field>
                      <Field label="$7,500 Mentorship & Community">
                        <Select yesLabel="Yes" noLabel="No" value={mentorshipLT} onChange={setMentorshipLT} />
                      </Field>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                      <Tile label="Total investment" value={money(totalInvest)} />
                      <Tile label="Annual (after options)" value={money(afterLT)} />
                      <Tile label="Payback (months)" value={Number.isFinite(paybackLT)? paybackLT.toFixed(2) : '—'} />
                      <Tile label="Year‑1 ROI" value={`${roiLT.toFixed(2)}×`} />
                    </div>
                  </section>
                )}
              </>
            )}
          </div>
        );
      }

      function Tile({label, value}) {
        return <div className="rounded-xl p-4 border bg-gray-50"><div className="text-xs text-gray-600">{label}</div><div className="text-xl font-semibold">{value}</div></div>;
      }
      function Field({label, children}) { return <label className="block"><div className="text-sm font-medium text-gray-700 mb-1">{label}</div>{children}</label>; }
      function Select({value,onChange,yesLabel='Yes',noLabel='No'}) {
        return (
          <select value={value} onChange={(e)=>onChange(e.target.value)}
            className="w-full rounded-lg border px-3 py-2 bg-white">
            <option>{noLabel}</option><option>{yesLabel}</option>
          </select>
        );
      }

      ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
    </script>
  </body>
</html>
